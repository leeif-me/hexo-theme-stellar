<%
function layoutDiv() {
  if (page.layout == 'wiki' && !page.references) {
    return '';
  }
  let el = '';
  el += '<div class="references-wrap">';
  if (page.references && page.references.length > 0) {
    el += '<section id="references">';
    el += '<div class="header">';
    el += '<span>' + __('meta.references') + '</span>';
    el += '</div>';
    el += '<div class="body"><ul>';
    page.references.forEach((item, i) => {
      el += '<li class="post-title">';
      el += '<a href="' + item.url + '">';
      el += item.title;
      el += '</a>';
      el += '</li>';
    });
    el += '</ul></div>';
    el += '</section>';
  }

  if (page.layout == 'post') {
    if (theme.article.license && page.license != false) {
      el += '<section id="license">';
      el += '<div class="header">';
      el += '<span>' + __('meta.license') + '</span>';
      el += '</div>';
      el += '<div class="body">';
      el += markdown(page.license || theme.article.license);
      el += '</div>';
      el += '</section>';
    }

    if (theme.article.share && page.share != false) {
      el += '<section id="share">';
      el += '<div class="header">';
      el += '<span>' + __('meta.share') + '</span>';
      el += '</div>';
      el += '<div class="body">';
      el += '<div class="link"><input class="copy-area" readonly="true" id="copy-link" value="' + page.permalink + '" /></div>';
      el += '<div class="social-wrap">';
      theme.article.share.forEach((item, i) => {
        if (['wechat', 'weibo', 'email', 'link'].includes(item)) {
          el += '<a class="social share-item ' + item + '"';
          if (item == 'wechat') {
            el += ' onclick=\'util.toggle_qrcode()\'';
          } else if (item == 'weibo') {
            el += ' href="http://service.weibo.com/share/share.php?url=' + page.permalink;
            el += '&title=' + (page.seo_title || page.title) + ' - ' + config.title;
            if (page.latyout == 'post' && page.cover) {
              el += '&pics=' + page.cover;
            } else if (page.latyout == 'wiki' && page.logo && page.logo.src) {
              el += '&pics=' + page.logo.src;
            }
            el += '&summary=' + truncate(page.description || strip_html(page.excerpt || page.content), {length: 120});
            el += '"';
          } else if (item == 'email') {
            el += ' href="mailto:?subject=' + (page.title || page.seo_title) + ' - ' + config.title + '&amp;'
            el += 'body=' + page.permalink + '"';
          } else if (item == 'link') {
            el += ' onclick=\'util.copy_link()\'';
          }
          el += '>';
          if (item == 'wechat') {
            el += '<img src="https://7.dusays.com/2021/02/24/b32ef3da1162a.svg"/>';
          } else if (item == 'weibo') {
            el += '<img src="https://7.dusays.com/2021/02/24/80c07e4dbb303.svg"/>';
          } else if (item == 'email') {
            el += '<img src="https://7.dusays.com/2021/02/24/a1b00e20f425d.svg"/>';
          } else if (item == 'link') {
            el += '<img src="https://7.dusays.com/2021/02/24/8411ed322ced6.svg"/>';
          }
          el += '</a>';
        }
      });
      el += '</div>';
      if (theme.article.share.includes('wechat')) {
        el += '<div class="qrcode" id="qrcode-wechat" style="display:none">';
        const src = qrcode(url,{margin:1,size:8});
        el += '<img src="' + src + '"/>';
        el += '</div>';
      }
      el += '</div>';
      el += '</section>';
    }
  }

  el += '</div>';
  return el;
}
%>
<%- layoutDiv(); %>
