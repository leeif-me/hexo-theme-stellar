$dynamic-background-h = hue($dynamic-background)
$dynamic-background-s = saturation($dynamic-background)
$dynamic-background-l = lightness($dynamic-background)

$dynamic-block-h = hue($dynamic-block)
$dynamic-block-s = saturation($dynamic-block)
$dynamic-block-l = lightness($dynamic-block)

$dynamic-code-h = hue($dynamic-code)
$dynamic-code-s = saturation($dynamic-code)
$dynamic-code-l = lightness($dynamic-code)

$dynamic-text-h = hue($dynamic-text)
$dynamic-text-s = saturation($dynamic-text)
$dynamic-text-l = lightness($dynamic-text)

set_text_dark()
  --text-p0: hsl($dynamic-text-h, $dynamic-text-s, 0)
  --text-p1: hsl($dynamic-text-h, $dynamic-text-s, $dynamic-text-l)
  --text-p2: hsl($dynamic-text-h, $dynamic-text-s, $dynamic-text-l / 0.5 * 0.75)
  --text-p3: hsl($dynamic-text-h, $dynamic-text-s, $dynamic-text-l / 0.5 * 1.25)
  --text-p4: hsl($dynamic-text-h, $dynamic-text-s, $dynamic-text-l / 0.5 * 1.5)
  --text-meta: hsl($dynamic-text-h, $dynamic-text-s, $dynamic-text-l / 0.5 * 2)
  --text-code: hsl($dynamic-code-h, $dynamic-code-s, $dynamic-code-l * 1)

set_text_light()
  --text-p0: hsl($dynamic-text-h, $dynamic-text-s, 100)
  --text-p1: hsl($dynamic-text-h, $dynamic-text-s, 100 - $dynamic-text-l / 0.5 * 0.25)
  --text-p2: hsl($dynamic-text-h, $dynamic-text-s, 100 - $dynamic-text-l / 0.5 * 0.5)
  --text-p3: hsl($dynamic-text-h, $dynamic-text-s, 100 - $dynamic-text-l / 0.5 * 1)
  --text-p4: hsl($dynamic-text-h, $dynamic-text-s, 100 - $dynamic-text-l / 0.5 * 1.25)
  --text-meta: hsl($dynamic-text-h, $dynamic-text-s, 100 - $dynamic-text-l / 0.5 * 1.5)
  --text-code: hsl($dynamic-code-h, $dynamic-code-s, 48)

:root
  --site-bg: hsl($dynamic-background-h, $dynamic-background-s, 98)
  --card: hsl($dynamic-block-h, $dynamic-block-s, 100)
  --block: hsl($dynamic-block-h, $dynamic-block-s, 95)
  --block-border: hsl($dynamic-block-h, $dynamic-block-s, 90)
  --block-hover: hsl($dynamic-block-h, $dynamic-block-s, 92)
  --block-lighten: hsl($dynamic-block-h, $dynamic-block-s, 100)
  set_text_dark()
  --theme-bg: $color-theme
  --theme-link: $color-link

set_darkmode()
  :root
    --site-bg: hsl($dynamic-background-h, $dynamic-background-s / 2, 16)
    --card: hsl($dynamic-block-h, $dynamic-block-s * 1.5, 25)
    --block: hsl($dynamic-block-h, $dynamic-block-s, 12)
    --block-border: hsl($dynamic-block-h, $dynamic-block-s, 24)
    --block-hover: hsl($dynamic-block-h, $dynamic-block-s, 9)
    --block-lighten: hsl($dynamic-block-h, $dynamic-block-s, 30)
    set_text_light()
    @media screen and (max-width: $device-mobile-max)
      --site-bg: black

if hexo-config('style.darkmode') == 'auto'
  // 系统的dark模式
  @media (prefers-color-scheme: dark)
    set_darkmode()


if hexo-config('style.darkmode') == 'always'
  set_darkmode()
